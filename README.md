# 🚀 MarketingBot — Профессиональный ИИ-ассистент

> **Stable & Resilient Telegram Bot for Marketing Analytics & Support**

MarketingBot — это высоконадежный инструмент для автоматизации маркетинга, поддержки пользователей и глубокой аналитики объектов недвижимости. Бот интегрирован с **Google Gemini AI** и использует **Google Sheets** как единый источник данных.

## 📚 Документация (Single Source of Truth)

Основная техническая база знаний проекта находится здесь:
👉 **[TECHNICAL_DOCUMENTATION_RU.md](docs/TECHNICAL_DOCUMENTATION_RU.md)**

Там вы найдете описание архитектуры, структуры таблиц и логики работы ИИ.

---

## 🌟 Ключевые возможности

1.  **🤖 Умный Чат (Gemini):** Профессиональные консультации на базе модели `gemini-3-flash-preview`.
2.  **📊 Аналитика 360:** Глубокий анализ объектов недвижимости (сравнение с конкурентами, ранг цены, прогноз сроков продажи) с генерацией PDF-отчётов.
3.  **🔐 Авторизация через Mini App:** Безопасный доступ сотрудников по коду партнера и номеру телефона.
4.  **📈 Мониторинг Акций:** Автоматическая рассылка уведомлений о новых маркетинговых предложениях.
5.  **💬 Гибридная поддержка:** Автоматическая эскалация сложных запросов на живых специалистов.

## 📂 Структура проекта

*   `bot.py` — Точка входа, инициализация всех сервисов.
*   `handlers/` — Обработчики команд, текстовых сообщений и аналитики.
*   `auth_service.py` — Логика авторизации и кэширования доступа.
*   `gemini_service.py` — Интеграция с Google AI и управление контекстом.
*   `appeals_service.py` — Работа с тикетами и историей в Google Sheets.
*   `sheets_gateway.py` — Обёртка над API таблиц (Retry + Circuit Breaker).
*   `docs/` — Техническая документация и архивы.

## 🚀 Быстрый старт (для разработчиков)

> **⚠️ КРИТИЧЕСКОЕ ПРАВИЛО:** Бот запускается **ТОЛЬКО на сервере Yandex Cloud**!
> Локальный запуск `python bot.py` **ЗАПРЕЩЕН** во избежание конфликтов сессий.

1.  **Установка зависимостей:**
    ```bash
    pip install -r requirements.txt
    ```
2.  **Настройка окружения:**
    Скопируйте структуру из `.env.example` в `.env` и добавьте API ключи.
### 3. Деплой на сервер (Yandex Cloud)
Обновление происходит автоматически по стратегии Blue-Green:
1.  **Подключитесь к серверу:**
    ```bash
    ssh marketing@89.169.176.108
    ```
2.  **Запустите деплой:**
    ```bash
    ./deploy.sh
    ```
    *Скрипт сам подтянет код из `main`, создаст окружение, проверит работоспособность и переключит бота.*

3.  **Откат (если что-то пошло не так):**
    ```bash
    ./rollback.sh
    ```

---
*Документация актуализирована: Февраль 2026*
