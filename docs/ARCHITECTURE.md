```markdown
# Архитектура бота (свод)

Краткое описание: маркетинговый Telegram-бот на Python с плагинной архитектурой. Цели: легко расширяемый, безопасный запуск, удобная поддержка и тестирование.

Компоненты:
- `bot.py` — основной запускной файл: инициализация логов, загрузка .env, создание диспетчера/апдейтера и загрузка плагинов через `plugins/loader.py`.
- `plugins/` — каталог плагинов. Каждый плагин должен предоставлять функцию `register(dispatcher, bot, settings)` и опционально `unregister()`.
- `config/plugins.json` — включенные плагины и их настройки.
- `tools/` — утилиты (логирование переписки, запись реализаций, автогенератор документации).
- `docs/` — проектная документация (правила, реализации, changelog и пр.).

Потоки и сценарии:
- Запуск: `scripts/restart_bot.sh` читает `.env`, экспортирует переменные, останавливает старые инстансы и запускает `bot.py` в фоне с логированием в `logs/bot.log`.
- Обработчики команд: плагины регистрируют command/handler-ы через API выбранной Telegram-библиотеки (в нашем коде — адаптируемо для `python-telegram-bot`).
- Логирование: runtime-логи → `logs/bot.log`; проектная документация и результат реализации фиксируются в `docs/IMPLEMENTATIONS.md`.

Точки расширения:
- Добавление плагина: поместить модуль в `plugins/`, добавить запись в `config/plugins.json` и перезапустить бот.
- Добавление команды админ‑панели: реализовать плагин с проверкой по списку админов (env `ADMINS`).

Переменные окружения (важные):
- `TELEGRAM_TOKEN` — обязательна.
- `ADMINS` — список админ id через запятую (опционально).
- `ENV` — окружение (dev|prod).

Требования к плагину (контракт):
1. Наличие `register(dispatcher, bot, settings)`.
2. Опционально: `METADATA` с `name`, `version`, `description`.
3. Безопасность: не логировать секреты и избегать длинных dump-ов в `logs/`.

Процессы развёртывания и CI:
- CI должен запускать тесты, линтер и после merge в main/safe запускать автогенерацию документации (tools/generate_docs.py) и создавать PR с изменениями в `docs/` (опционально — сразу коммитить в ту же ветку при доверенном runner-е).

Примеры команд:
- Добавить плагин: создать `plugins/myplugin.py` с `register` и добавить в `config/plugins.json`.
- Перезапуск: `bash scripts/restart_bot.sh`.

`IMPLEMENTATIONS.md` → источник правды о том, как и почему сделаны изменения.

``` 
# Описание логики бота

Цель: бот — технический исполнитель задач пользователя. Он принимает задачи, редактирует код, создаёт документацию и ведёт лог переписки.

Ключевые компоненты:
- Взаимодействие с пользователем: обмен сообщениями, приём задач, уточнения.
- Документация: файлы в `docs/`.
- Утилиты: `tools/` для автоматизации (логирование, форматы).

Поведение и потоки:
1. Получение задачи от пользователя.
2. Планирование (создание TODO, расстановка приоритетов).
3. Выполнение изменения в коде/документации.
4. Валидация (сбор ошибок, тесты) и отчёт.
5. Обновление логов и документации.

Данные и хранение:
- Все тексты документации хранятся в `docs/`.
- Скрипты — в `tools/`.
