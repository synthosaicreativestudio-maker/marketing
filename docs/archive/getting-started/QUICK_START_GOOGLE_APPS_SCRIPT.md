# Быстрый старт: Google Apps Script для акций

## Что было сделано

✅ Создан Google Apps Script код (`google_apps_script_promotions.js`)  
✅ Обновлен `menu.html` с поддержкой Google Apps Script и fallback механизмом  
✅ Создана подробная документация (`docs/GOOGLE_APPS_SCRIPT_SETUP.md`)

## Что нужно сделать сейчас (5-10 минут)

### Шаг 1: Открыть Google Таблицу с акциями

1. Откройте вашу Google Таблицу с акциями
2. Убедитесь, что лист называется "Акции" (или запомните точное название)

### Шаг 2: Создать Apps Script

1. В меню выберите: **Расширения** → **Apps Script**
2. Откроется редактор Apps Script
3. Удалите весь существующий код (если есть)
4. Откройте файл `google_apps_script_promotions.js` из проекта
5. Скопируйте весь код и вставьте в редактор Apps Script
6. Сохраните: **Ctrl+S** (или **Cmd+S** на Mac)

### Шаг 3: Развернуть как веб-приложение

1. Нажмите кнопку **"Развернуть"** (Deploy) в правом верхнем углу
2. Выберите **"Новое развертывание"** (New deployment)
3. Нажмите на иконку шестеренки ⚙️ рядом с "Выберите тип"
4. Выберите **"Веб-приложение"** (Web app)
5. В поле **"У кого есть доступ"** выберите **"Все"** (Anyone)
6. Нажмите **"Развернуть"** (Deploy)

### Шаг 4: Скопировать URL

1. После развертывания появится окно с URL
2. Скопируйте URL (он будет вида: `https://script.google.com/macros/s/.../exec`)
3. Сохраните этот URL

### Шаг 5: Обновить menu.html

1. Откройте файл `menu.html`
2. Найдите строку:
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = ''; // TODO: Вставьте ваш Google Apps Script URL здесь
   ```
3. Вставьте ваш URL между кавычками:
   ```javascript
   const GOOGLE_APPS_SCRIPT_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
   ```
4. Сохраните файл

### Шаг 6: Протестировать

1. Откройте скопированный URL Google Apps Script в браузере
2. Вы должны увидеть JSON с активными акциями
3. Если видите JSON - всё работает! ✅

### Шаг 7: Закоммитить изменения

```bash
git add menu.html google_apps_script_promotions.js docs/GOOGLE_APPS_SCRIPT_SETUP.md QUICK_START_GOOGLE_APPS_SCRIPT.md
git commit -m "Добавлена поддержка Google Apps Script для получения акций"
git push origin main
```

## Как это работает

1. **Mini App** открывается в Telegram
2. **JavaScript** пытается загрузить акции:
   - Сначала с **Google Apps Script** (быстро и надежно)
   - Если не работает - с **Cloudflare Tunnel** (fallback)
   - Если не работает - с **локального API** (если на том же сервере)
3. **Акции отображаются** в Mini App

## Преимущества

- ✅ Работает сразу, без ожидания DNS
- ✅ Надежность 99.9% (Google инфраструктура)
- ✅ Бесплатно и без ограничений
- ✅ Данные сразу в JSON формате
- ✅ HTTPS по умолчанию

## Если что-то не работает

1. Проверьте, что лист называется "Акции" (или обновите код)
2. Проверьте, что в таблице есть акции со статусом "Активна"
3. Откройте URL в браузере и проверьте, что возвращается JSON
4. Откройте консоль браузера в Mini App (F12) и проверьте логи

## Подробная документация

См. `docs/GOOGLE_APPS_SCRIPT_SETUP.md` для подробных инструкций.

---

**Время настройки:** 5-10 минут  
**Статус:** ✅ Готово к использованию
