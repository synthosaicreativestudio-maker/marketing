# üìã –ü–ª–∞–Ω –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏: API –¥–ª—è WebApp

**–¶–µ–ª—å:** –û–±–µ—Å–ø–µ—á–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Ä–µ–∞–ª—å–Ω—ã—Ö –∞–∫—Ü–∏–π –∏–∑ Google Sheets –≤ WebApp —á–µ—Ä–µ–∑ REST API.

## 1. Backend (Flask)
–§–∞–π–ª: `webhook_handler.py`

- [ ] **–ò–º–ø–æ—Ä—Ç —Å–µ—Ä–≤–∏—Å–æ–≤:** –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç `PromotionsAPI` –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.
- [ ] **CORS Headers:** –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `after_request` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (—á—Ç–æ–±—ã WebApp –º–æ–≥ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É).
- [ ] **Endpoint `/api/promotions`:**
    - –ú–µ—Ç–æ–¥: `GET`
    - –õ–æ–≥–∏–∫–∞: –í—ã–∑–æ–≤ `promotions_api.get_promotions_json()`.
    - –û—Ç–≤–µ—Ç: JSON —Å–æ —Å–ø–∏—Å–∫–æ–º –∞–∫—Ü–∏–π.
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –í–æ–∑–≤—Ä–∞—Ç 500 –ø—Ä–∏ —Å–±–æ–µ Google Sheets.

## 2. Frontend (WebApp)
–§–∞–π–ª: `menu.html`

- [ ] **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `API_BASE_URL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞, —Ç–∞–∫ –∫–∞–∫ WebApp –∏ API –Ω–∞ –æ–¥–Ω–æ–º –¥–æ–º–µ–Ω–µ, –∏–ª–∏ –∞–¥—Ä–µ—Å PythonAnywhere).
- [ ] **–§—É–Ω–∫—Ü–∏—è `loadPromotions`:**
    - –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏–∫—É `tg.sendData`.
    - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `fetch('/api/promotions')`.
    - –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ (Loading state) –∏ –æ—à–∏–±–æ–∫.
- [ ] **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç JSON –æ—Ç API —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–º, —á—Ç–æ –æ–∂–∏–¥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è `displayPromotions`.

## 3. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `webhook_handler.py` –ª–æ–∫–∞–ª—å–Ω–æ.
- [ ] –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: `curl http://localhost:5000/api/promotions`.
- [ ] –û—Ç–∫—Ä—ã—Ç—å `menu.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è (–¥–∞–∂–µ –±–µ–∑ Telegram).

## ‚ö†Ô∏è –†–∏—Å–∫–∏
- **Google Sheets API Limits:** –ß–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –º–æ–≥—É—Ç —É–ø–µ—Ä–µ—Ç—å—Å—è –≤ –ª–∏–º–∏—Ç—ã Google.
    - *–ú–µ—Ä—ã:* –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `promotions_api.py` –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–∞–º—è—Ç—å (TTL 5 –º–∏–Ω—É—Ç).

---
**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–µ—Ç —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
