# API Reference - MarketingBot v3.0

## –û–±–∑–æ—Ä API

MarketingBot v3.0 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å OpenAI Assistant.

## AuthService

### –ú–µ—Ç–æ–¥—ã

#### `get_user_auth_status(telegram_id: int) -> bool`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, False –∏–Ω–∞—á–µ

**–ü—Ä–∏–º–µ—Ä**:
```python
auth_service = AuthService()
is_authorized = auth_service.get_user_auth_status(123456789)
```

#### `find_and_update_user(partner_code: str, partner_phone: str, telegram_id: int) -> bool`
–ò—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–æ–¥—É –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É, –æ–±–Ω–æ–≤–ª—è–µ—Ç Telegram ID.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `partner_code` (str): –ö–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `partner_phone` (str): –¢–µ–ª–µ—Ñ–æ–Ω –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω –∏ –æ–±–Ω–æ–≤–ª–µ–Ω

**–ü—Ä–∏–º–µ—Ä**:
```python
success = auth_service.find_and_update_user("12345", "89123456789", 123456789)
```

#### `force_check_auth_status(telegram_id: int) -> bool`
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∫—ç—à.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω

## OpenAIService

### –ú–µ—Ç–æ–¥—ã

#### `is_enabled() -> bool`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –≤–∫–ª—é—á–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å OpenAI.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω

#### `ask(user_id: int, message: str) -> str`
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É –∏ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `user_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `message` (str): –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `str`: –û—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä**:
```python
openai_service = OpenAIService()
response = openai_service.ask(123456789, "–ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?")
```

#### `get_or_create_thread(user_id: int) -> str`
–ü–æ–ª—É—á–∞–µ—Ç –∏–ª–∏ —Å–æ–∑–¥–∞–µ—Ç Thread –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `user_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `str`: ID Thread

## AppealsService

### –ú–µ—Ç–æ–¥—ã

#### `is_available() -> bool`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –¥–æ—Å—Ç—É–ø–µ–Ω

#### `create_appeal(code: str, phone: str, fio: str, telegram_id: int, text: str) -> bool`
–°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `code` (str): –ö–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `phone` (str): –¢–µ–ª–µ—Ñ–æ–Ω –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `fio` (str): –§–ò–û –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- `text` (str): –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ/–æ–±–Ω–æ–≤–ª–µ–Ω–æ

**–ü—Ä–∏–º–µ—Ä**:
```python
appeals_service = AppealsService()
success = appeals_service.create_appeal(
    code="12345",
    phone="89123456789",
    fio="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
    telegram_id=123456789,
    text="–£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –æ–±—ä–µ–∫—Ç–∞"
)
```

#### `set_status_in_work(telegram_id: int) -> bool`
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è "–≤ —Ä–∞–±–æ—Ç–µ".

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

#### `get_appeal_status(telegram_id: int) -> str`
–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `str`: –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞—â–µ–Ω–∏—è (–Ω–æ–≤–æ–µ/–≤ —Ä–∞–±–æ—Ç–µ/—Ä–µ—à–µ–Ω–æ)

#### `check_for_responses() -> List[Dict]`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `List[Dict]`: –°–ø–∏—Å–æ–∫ –æ—Ç–≤–µ—Ç–æ–≤ —Å –¥–∞–Ω–Ω—ã–º–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞**:
```python
{
    'row': int,           # –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
    'telegram_id': str,   # ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    'response': str,      # –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞
    'code': str,          # –ö–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
    'fio': str            # –§–ò–û –ø–∞—Ä—Ç–Ω–µ—Ä–∞
}
```

#### `clear_response(row: int) -> bool`
–û—á–∏—â–∞–µ—Ç —è—á–µ–π–∫—É —Å –æ—Ç–≤–µ—Ç–æ–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `row` (int): –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ —è—á–µ–π–∫–∞ –æ—á–∏—â–µ–Ω–∞

#### `add_specialist_response(telegram_id: int, response_text: str) -> bool`
–î–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –∫ –æ–±—Ä–∞—â–µ–Ω–∏—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- `response_text` (str): –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω

#### `has_records() -> bool`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–ø–∏—Å–∏

#### `get_user_appeals(telegram_id: int) -> List[Dict]`
–ü–æ–ª—É—á–∞–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `List[Dict]`: –°–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## ResponseMonitor

### –ú–µ—Ç–æ–¥—ã

#### `start()`
–ó–∞–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤.

#### `stop()`
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤.

#### `send_test_response(telegram_id: int, test_message: str)`
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `telegram_id` (int): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- `test_message` (str): –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

## Handlers

### –§—É–Ω–∫—Ü–∏–∏

#### `create_main_menu_keyboard() -> ReplyKeyboardMarkup`
–°–æ–∑–¥–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–æ–µ –º–µ–Ω—é —Å –æ–ø—Ü–∏—è–º–∏.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `ReplyKeyboardMarkup`: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏

**–ö–Ω–æ–ø–∫–∏**:
- "üë®‚Äçüíº –û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É"
- "ü§ñ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º"

## WebApp (menu.html)

### JavaScript —Ñ—É–Ω–∫—Ü–∏–∏

#### `toggleServiceCategory(categoryId: string) -> void`
–ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ –≤ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `categoryId` (string): ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- –û–±–Ω–æ–≤–ª—è–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (—Å—Ç—Ä–µ–ª–∫–∏)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∞–Ω–∏–º–∞—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è

**–ü—Ä–∏–º–µ—Ä**:
```javascript
// –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π"
toggleServiceCategory('social-content');

// –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–î–∏–∑–∞–π–Ω –∏ –±—Ä–µ–Ω–¥–∏–Ω–≥"
toggleServiceCategory('design');
```

#### `showSection(sectionId: string) -> void`
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é –≤ WebApp.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `sectionId` (string): ID —Å–µ–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–µ–∫—Ü–∏–∏**:
- `'promotions'` - –ê–∫—Ü–∏–∏ –∏ —Å–æ–±—ã—Ç–∏—è
- `'tools'` - –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- `'analytics'` - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –û–ù
- `'knowledge'` - –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π
- `'services'` - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã

#### `showMainMenu() -> void`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é WebApp.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
- –°–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —Å–µ–∫—Ü–∏–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å 5 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
- –°–∫—Ä—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –≤ Telegram

### HTML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

#### –°–µ–∫—Ü–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª—É–≥:
```html
<div id="services-section" class="content-section">
    <button class="back-button" onclick="showMainMenu()">
        ‚Üê –ù–∞–∑–∞–¥ –∫ –º–µ–Ω—é
    </button>
    <h2 class="section-title">üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª—É–≥–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã</h2>
    <div class="section-content">
        <div class="services-accordion">
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ -->
        </div>
    </div>
</div>
```

#### –ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥:
```html
<div class="service-category">
    <button class="service-category-header" onclick="toggleServiceCategory('category-id')">
        <span class="service-category-icon">üì±</span>
        <span class="service-category-title">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</span>
        <span class="service-category-arrow">‚ñº</span>
    </button>
    <div class="service-category-content" id="category-id">
        <ul class="service-list">
            <li>–£—Å–ª—É–≥–∞ 1</li>
            <li>–£—Å–ª—É–≥–∞ 2</li>
        </ul>
    </div>
</div>
```

### CSS –∫–ª–∞—Å—Å—ã

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã:
- `.services-accordion` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
- `.service-category` - –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥
- `.service-category-header` - –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∫–Ω–æ–ø–∫–∞)
- `.service-category-content` - —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `.service-list` - —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

#### –°–æ—Å—Ç–æ—è–Ω–∏—è:
- `.service-category-header.active` - –∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- `.service-category-content.active` - –æ—Ç–∫—Ä—ã—Ç–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- `.service-category-arrow` - —Å—Ç—Ä–µ–ª–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram WebApp

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```javascript
let tg = window.Telegram.WebApp;
tg.ready();
tg.expand();
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–º—ã:
```javascript
function updateTheme() {
    const root = document.documentElement;
    root.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#ffffff');
    root.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#000000');
    // ... –¥—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–º—ã
}
```

#### –ù–∞–≤–∏–≥–∞—Ü–∏—è:
```javascript
// –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–µ–∫—Ü–∏—é
function showBackButton() {
    tg.BackButton.show();
}

// –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É "–ù–∞–∑–∞–¥" –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
function hideBackButton() {
    tg.BackButton.hide();
}
```

#### `_is_user_escalation_request(text: str) -> bool`
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –ø—Ä–æ—Å–∏—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–µ–¥–∏–Ω–∏—Ç—å –µ–≥–æ —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º –ø–æ –∫–ª—é—á–µ–≤—ã–º —Ñ—Ä–∞–∑–∞–º.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `text` (str): –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã**:
- "–ø–æ–º–æ—á—å –Ω–µ –º–æ–∂–µ—Ç–µ", "–Ω–µ –º–æ–∂–µ—Ç–µ –ø–æ–º–æ—á—å"
- "—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –Ω—É–∂–µ–Ω", "–Ω—É–∂–µ–Ω —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç"
- "—á–µ–ª–æ–≤–µ–∫ –Ω—É–∂–µ–Ω", "–∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫"
- "—Å–æ–µ–¥–∏–Ω–∏—Ç–µ", "–ø–æ–∑–≤–æ–Ω–∏—Ç—å", "–∑–≤–æ–Ω–æ–∫"
- "–ø—Ä–æ–±–ª–µ–º–∞", "–Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è", "–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
- "—Å–ª–æ–∂–Ω–æ", "–Ω–µ –ø–æ–Ω–∏–º–∞—é", "–æ–±—ä—è—Å–Ω–∏—Ç–µ"

**–ü—Ä–∏–º–µ—Ä**:
```python
if _is_user_escalation_request("–∞ –≤—ã –º–Ω–µ –ø–æ–º–æ—á—å –Ω–µ –º–æ–∂–µ—Ç–µ?"):
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É
    appeals_service.set_status_in_work(user.id)
```

#### `_should_show_specialist_button(text: str) -> bool`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
- `text` (str): –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç**:
- `bool`: True –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

#### `start_command_handler(auth_service: AuthService)`
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start.

#### `web_app_data_handler(auth_service: AuthService)`
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö –∏–∑ WebApp.

#### `chat_handler(auth_service: AuthService, openai_service: OpenAIService, appeals_service: AppealsService)`
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

#### `appeals_command_handler(auth_service: AuthService, appeals_service: AppealsService)`
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /appeals.

#### `callback_query_handler(auth_service: AuthService, appeals_service: AppealsService)`
–û–±—Ä–∞–±–æ—Ç—á–∏–∫ callback queries (–∏–Ω–ª–∞–π–Ω –∫–Ω–æ–ø–∫–∏).

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### Telegram
- `TELEGRAM_TOKEN`: –¢–æ–∫–µ–Ω –±–æ—Ç–∞
- `ADMIN_TELEGRAM_ID`: ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### OpenAI
- `OPENAI_API_KEY`: API –∫–ª—é—á OpenAI
- `OPENAI_ASSISTANT_ID`: ID –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

#### Google Sheets
- `SHEET_ID`: ID —Ç–∞–±–ª–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `APPEALS_SHEET_ID`: ID —Ç–∞–±–ª–∏—Ü—ã –æ–±—Ä–∞—â–µ–Ω–∏–π
- `SHEET_NAME`: –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `APPEALS_SHEET_NAME`: –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π
- `GCP_SA_FILE`: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É Service Account

#### WebApp
- `WEB_APP_URL`: –ë–∞–∑–æ–≤—ã–π URL WebApp (–¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –º–µ–Ω—é)
- `WEB_APP_MENU_URL`: URL WebApp –º–µ–Ω—é (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ WEB_APP_URL + "menu.html")

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

#### –¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø |
|---------|----------|-----|
| A | –ö–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ | String |
| B | –¢–µ–ª–µ—Ñ–æ–Ω –ø–∞—Ä—Ç–Ω–µ—Ä–∞ | String |
| C | –§–ò–û –ø–∞—Ä—Ç–Ω–µ—Ä–∞ | String |
| D | Telegram ID | String |
| E | –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | String |
| F | –î–∞—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | DateTime |

#### –¢–∞–±–ª–∏—Ü–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø | –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è |
|---------|----------|-----|-------------------|
| A | –ö–æ–¥ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ | String | - |
| B | –¢–µ–ª–µ—Ñ–æ–Ω –ø–∞—Ä—Ç–Ω–µ—Ä–∞ | String | - |
| C | –§–ò–û –ø–∞—Ä—Ç–Ω–µ—Ä–∞ | String | - |
| D | Telegram ID | String | - |
| E | –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π | Multi-line String | - |
| F | –°—Ç–∞—Ç—É—Å | Enum | –ë–µ–∑ —Ü–≤–µ—Ç–∞ / #f4cccc (–∫—Ä–∞—Å–Ω–∞—è) / #d9ead3 (–∑–µ–ª–µ–Ω–∞—è) / –±–µ–ª—ã–π (–ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏) |
| G | –û—Ç–≤–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ | String | - |
| H | –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | DateTime | - |

**–°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞—â–µ–Ω–∏–π**:
- `–Ω–æ–≤–æ–µ` - –Ω–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ (–±–µ–∑ –∑–∞–ª–∏–≤–∫–∏)
- `–≤ —Ä–∞–±–æ—Ç–µ` - –ø–µ—Ä–µ–¥–∞–Ω–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É (#f4cccc - –∫—Ä–∞—Å–Ω–∞—è –∑–∞–ª–∏–≤–∫–∞)
- `—Ä–µ—à–µ–Ω–æ` - —Ä–µ—à–µ–Ω–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º (#d9ead3 - –∑–µ–ª–µ–Ω–∞—è –∑–∞–ª–∏–≤–∫–∞)
- –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ - —Å—Ç–∞—Ç—É—Å "—Ä–µ—à–µ–Ω–æ" + –±–µ–ª–∞—è –∑–∞–ª–∏–≤–∫–∞

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π

#### `SheetsNotConfiguredError`
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Google Sheets.

#### `telegram.error.Conflict`
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏ –±–æ—Ç–∞.

#### `openai.OpenAIError`
–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö OpenAI API.

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```python
try:
    result = service.method()
except SpecificError as e:
    logger.error(f"Error: {e}")
    return fallback_value
except Exception as e:
    logger.error(f"Unexpected error: {e}")
    return None
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- `DEBUG`: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- `INFO`: –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ
- `WARNING`: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `ERROR`: –û—à–∏–±–∫–∏
- `CRITICAL`: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

### –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤

```python
logger.info(f"CHAT_HANDLER: –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {user.id}: {text}")
logger.error(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è: {e}", exc_info=True)
logger.warning(f"AppealsService –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: {e}")
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from auth_service import AuthService
from openai_service import OpenAIService
from appeals_service import AppealsService

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤
auth_service = AuthService()
openai_service = OpenAIService()
appeals_service = AppealsService()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
if auth_service.get_user_auth_status(123456789):
    # –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è
    appeals_service.create_appeal(
        code="12345",
        phone="89123456789",
        fio="–ò–≤–∞–Ω–æ–≤ –ò.–ò.",
        telegram_id=123456789,
        text="–í–æ–ø—Ä–æ—Å –ø–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É"
    )
    
    # –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É
    response = openai_service.ask(123456789, "–ü—Ä–∏–≤–µ—Ç!")
    print(response)
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

```python
from response_monitor import ResponseMonitor

# –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∞
monitor = ResponseMonitor(bot, appeals_service)

# –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
await monitor.start()

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
await monitor.stop()
```

### –†–∞–±–æ—Ç–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–º –º–µ–Ω—é

```python
from handlers import create_main_menu_keyboard

# –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω—é
keyboard = create_main_menu_keyboard()

# –û—Ç–ø—Ä–∞–≤–∫–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
await update.message.reply_text(
    "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
    reply_markup=keyboard
)
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

API MarketingBot v3.0 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –∏ —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏. –í—Å–µ –º–µ—Ç–æ–¥—ã –∏–º–µ—é—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
