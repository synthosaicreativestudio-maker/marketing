# –ê–ù–ê–õ–ò–ó –¢–ï–ö–£–©–ï–ì–û –°–ö–†–ò–ü–¢–ê

## –û–ë–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

**–í–µ—Ä—Å–∏—è:** 3.0.8  
**–Ø–∑—ã–∫:** Google Apps Script (JavaScript)  
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** Google –¢–∞–±–ª–∏—Ü—ã  

## –°–¢–†–£–ö–¢–£–†–ê –õ–ò–°–¢–û–í (–∏–∑ –∫–æ–¥–∞)

### –ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•
- `'1. 2. –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ'` - –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (—Å—Ç–æ–ª–±—Ü—ã A2:N)
- `'2. 2. –∞–∫—Ç–∏–≤–Ω—ã–µ'` - –∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (—Å—Ç–æ–ª–±—Ü—ã A2:M) 
- `'4. 2. –∞–∫—Ç–∏–≤–Ω—ã–µ –≤ –≥—Ä—É–ø–ø–µ'` - –æ–±—ä–µ–∫—Ç—ã –≥—Ä—É–ø–ø—ã (—Å—Ç–æ–ª–±—Ü—ã A2:O)

### –†–ï–ö–õ–ê–ú–ù–´–ï –î–ê–ù–ù–´–ï
- `'3. 56. –∞–≤–∏—Ç–æ'` - –¥–∞–Ω–Ω—ã–µ –ê–≤–∏—Ç–æ (—Å—Ç–æ–ª–±—Ü—ã B2:D)
- `'5. 56. —Ü–∏–∞–Ω'` - –¥–∞–Ω–Ω—ã–µ –¶–∏–∞–Ω (—Å—Ç–æ–ª–±—Ü—ã B2:D)
- `'6. 56. –¥–æ–º–∫–ª–∏–∫'` - –¥–∞–Ω–Ω—ã–µ –î–æ–º–∫–ª–∏–∫ (—Å—Ç–æ–ª–±—Ü—ã B2:D)

### –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ï –õ–ò–°–¢–´
- `'–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—Å–µ—Ö –û–ù –≤ –≥—Ä—É–ø–ø–µ'` - –æ—Å–Ω–æ–≤–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ª–∏—Å—Ç
- `'–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã–µ –∏ –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ'` - –º–∞—Å—Å–∏–≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
- `'–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –û–ù –ø–æ –∞–¥—Ä–µ—Å—É/–∫–æ–¥—É'` - –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

## –ö–õ–Æ–ß–ï–í–´–ï –§–£–ù–ö–¶–ò–ò

### 1. –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
```javascript
onOpen()                    // –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω—é
installTriggers()           // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
startAllFunctions()         // –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å
```

### 2. –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–•
```javascript
clearSheets()               // –û—á–∏—Å—Ç–∫–∞ –ª–∏—Å—Ç–æ–≤
copyFromActiveGroup()       // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –≥—Ä—É–ø–ø—ã
copyFromSource()            // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–ª–æ—â–∞–¥–æ–∫
setAdditionalHeaders()      // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
```

### 3. –û–°–ù–û–í–ù–û–ô –ê–ù–ê–õ–ò–ó
```javascript
findCompetitorsForAllObjects()  // –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞
groupDataByDistrict()           // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞–π–æ–Ω–∞–º
processDistrictData()           // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–π–æ–Ω–∞
formatCompetitorRow()           // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
```

### 4. –†–ê–°–ß–ï–¢–ù–´–ï –§–£–ù–ö–¶–ò–ò
```javascript
calculateObjectMetrics()        // –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—ä–µ–∫—Ç–∞
calculateTimeOnMarket()         // –ü—Ä–æ–≥–Ω–æ–∑ —Å—Ä–æ–∫–æ–≤
calculatePriceFork()            // –¶–µ–Ω–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
calculateQualityScore()         // –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
getLiquidityType()              // –¢–∏–ø –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
getMarketAssessment()           // –û—Ü–µ–Ω–∫–∞ —Ä—ã–Ω–∫–∞
```

### 5. –û–¢–ß–ï–¢–´ –ò –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
```javascript
onEditTrigger()                 // –¢—Ä–∏–≥–≥–µ—Ä —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
generateFullReport()            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
buildReportSummaries()          // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–∞
callGemini()                    // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI
```

## –°–¢–†–£–ö–¢–£–†–ê –î–ê–ù–ù–´–•

### –õ–ò–°–¢ "4. 2. –∞–∫—Ç–∏–≤–Ω—ã–µ –≤ –≥—Ä—É–ø–ø–µ" (A:O)
```
A: ‚Ññ
B: –†–∞–π–æ–Ω  
C: –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞
D: –ö–æ–ª-–≤–æ –∫–æ–º–Ω–∞—Ç
E: –ü–ª–æ—â–∞–¥—å
F: –ö–æ–¥
G: –¢–∏–ø —Ä–µ–º–æ–Ω—Ç–∞
H: –¶–µ–Ω–∞
I: –≠—Ç–∞–∂
J: –≠—Ç–∞–∂–Ω–æ—Å—Ç—å
K: –ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏
L: –ø—Ä–æ—Ñ. —Ñ–æ—Ç–æ
M: –æ–ø–∏—Å–∞–Ω–∏–µ
N: –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞
O: –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç
```

### –õ–ò–°–¢ "2. 2. –∞–∫—Ç–∏–≤–Ω—ã–µ" (A:M)
```
A: –î–∞—Ç–∞ –≤—ã–≤–æ–¥–∞ –∑–∞—è–≤–∫–∏
B: –†–∞–π–æ–Ω
C: –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞
D: –ö–æ–ª-–≤–æ –∫–æ–º–Ω–∞—Ç
E: –ü–ª–æ—â–∞–¥—å
F: –¢–∏–ø —Ä–µ–º–æ–Ω—Ç–∞
G: –¶–µ–Ω–∞
H: –≠—Ç–∞–∂
I: –≠—Ç–∞–∂–Ω–æ—Å—Ç—å
J: –ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏
K: –°—Å—ã–ª–∫–∞ (–∞–∫—Ç–∏–≤–Ω—ã–µ)
L: –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ–º–∞
M: [–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ]
```

### –õ–ò–°–¢ "1. 2. –ø—Ä–æ–¥–∞–Ω–Ω—ã–µ" (A:N)
```
A: –î–∞—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏
B: –†–∞–π–æ–Ω
C: –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞
D: –ö–æ–ª-–≤–æ –∫–æ–º–Ω–∞—Ç
E: –ü–ª–æ—â–∞–¥—å
F: –¢–∏–ø —Ä–µ–º–æ–Ω—Ç–∞
G: –¶–µ–Ω–∞
H: –≠—Ç–∞–∂
I: –≠—Ç–∞–∂–Ω–æ—Å—Ç—å
J: –ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏
K: –°—Å—ã–ª–∫–∞ (–ø—Ä–æ–¥–∞–Ω–Ω—ã–µ)
L: –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
M: –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ–º–∞
N: [–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ]
```

## –ö–†–ò–¢–ï–†–ò–ò –§–ò–õ–¨–¢–†–ê–¶–ò–ò –ö–û–ù–ö–£–†–ï–ù–¢–û–í

### –û–°–ù–û–í–ù–´–ï –ö–†–ò–¢–ï–†–ò–ò
1. **–¢–∏–ø –æ–±—ä–µ–∫—Ç–∞** - —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
2. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç** - ¬±1 (–¥–æ–ø—É—Å–∫)
3. **–ü–ª–æ—â–∞–¥—å** - ¬±20% (–¥–æ–ø—É—Å–∫)
4. **–ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏** - ¬±10 –ª–µ—Ç (–¥–æ–ø—É—Å–∫)
5. **–†–∞–π–æ–Ω** - —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
6. **–†–µ–º–æ–Ω—Ç** - –µ—Å–ª–∏ —É –æ–±—ä–µ–∫—Ç–∞ —Ö–æ—Ä–æ—à–∏–π —Ä–µ–º–æ–Ω—Ç, —Ç–æ –∏ —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–æ—Ä–æ—à–∏–π
7. **–î–∞—Ç–∞** - —Ç–æ–ª—å–∫–æ —Å–≤–µ–∂–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–Ω–µ —Å—Ç–∞—Ä—à–µ 6 –º–µ—Å—è—Ü–µ–≤)

### –•–û–†–û–®–ò–ï –†–ï–ú–û–ù–¢–´
```javascript
const goodRepairs = [
    '–†–µ–º–æ–Ω—Ç –ø–æ –¥–∏–∑–∞–π–Ω –ø—Ä–æ–µ–∫—Ç—É',
    '–ï–≤—Ä–æ—Ä–µ–º–æ–Ω—Ç', 
    '–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ä–µ–º–æ–Ω—Ç'
];
```

## –†–ê–°–ß–ï–¢–ù–´–ï –ú–ï–¢–†–ò–ö–ò

### –õ–ò–ö–í–ò–î–ù–û–°–¢–¨
- **A+** - –∏–Ω–¥–µ–∫—Å > 25 –∏ —Å–ø—Ä–æ—Å ‚â• 3
- **A** - –∏–Ω–¥–µ–∫—Å ‚â• 20
- **B** - –∏–Ω–¥–µ–∫—Å ‚â• 10
- **C** - –∏–Ω–¥–µ–∫—Å ‚â• 5
- **C-** - –∏–Ω–¥–µ–∫—Å < 5

### –û–¶–ï–ù–ö–ê –†–´–ù–ö–ê
- **–ì–æ—Ä—è—á–∏–π —Ä—ã–Ω–æ–∫** - –∏–Ω–¥–µ–∫—Å > 25 –∏ —Å–ø—Ä–æ—Å > 3
- **–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** - –∏–Ω–¥–µ–∫—Å ‚â• 15 –∏ —Å–ø—Ä–æ—Å > 1.5
- **–•–æ–ª–æ–¥–Ω—ã–π —Ä—ã–Ω–æ–∫** - –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏

### –¶–ï–ù–û–í–´–ï –°–¢–†–ê–¢–ï–ì–ò–ò
1. **–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–¥–∞–∂–∞** - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è —Ü–µ–Ω–∞
2. **–†—ã–Ω–æ—á–Ω–∞—è** - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞
3. **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞

## –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° GEMINI AI

### –ü–†–û–ú–ü–¢
```
–¢—ã ‚Äî –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä. –¢–µ–±–µ –¥–∞–Ω —Å—É—Ö–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç-—Ä–µ–∑—é–º–µ. 
–¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –µ–≥–æ –≤ –≥–ª–∞–¥–∫–∏–π, –¥–µ–ª–æ–≤–æ–π, –Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç, 
—Å–æ—Ö—Ä–∞–Ω–∏–≤ –≤—Å—é —Å—É—Ç—å, —Ü–∏—Ñ—Ä—ã –∏ –≤—ã–≤–æ–¥—ã.
```

### –°–¢–†–£–ö–¢–£–†–ê –û–¢–ß–ï–¢–ê
1. –ö—Ä–∞—Ç–∫–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä—ã–Ω–∫–∞
2. –ü–æ–∑–∏—Ü–∏—è –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ —ç—Ç–æ–º —Ä—ã–Ω–∫–µ  
3. –ß–µ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–µ—Ö —Ü–µ–Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Å –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏

## –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò

### –ö–û–ù–°–¢–ê–ù–¢–´
```javascript
const STALE_LISTING_MONTHS = 6;    // –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
const TRIM_PERCENTAGE = 0.1;       // –û—Ç—Å–µ—á–µ–Ω–∏–µ –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ
const GEMINI_MODEL = 'gemini-1.5-flash-latest';
```

### –¢–†–ò–ì–ì–ï–†–´
- –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 6:00 –∏ 14:00 - `startAllFunctions()`
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ - `onEditTrigger()`

### –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö
- –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∏—Ä–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `Logger.log()`
- Graceful degradation

## –ü–†–û–ë–õ–ï–ú–´ –ò –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### –¢–ï–ö–£–©–ò–ï –ü–†–û–ë–õ–ï–ú–´
1. **–ù–µ–≥–∏–±–∫–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø—ã
2. **–†—É—á–Ω–æ–π –≤–≤–æ–¥** - –Ω–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —á–∞—Ç-–±–æ—Ç–æ–º
3. **–°—Ç–∞—Ç–∏—á–Ω–æ—Å—Ç—å** - –∞–Ω–∞–ª–∏–∑ —Ç–æ–ª—å–∫–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

### –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø
1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≥—Ä—É–ø–ø—ã
2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ø—Ä–∏ —Ä–æ—Å—Ç–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
3. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** - —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ç–∞–±–ª–∏—Ü—ã

## –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –î–õ–Ø –ú–û–î–ò–§–ò–ö–ê–¶–ò–ò

### –ì–û–¢–û–í–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
- ‚úÖ –†–∞—Å—á–µ—Ç–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Gemini AI
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

### –¢–†–ï–ë–£–ï–¢ –ê–î–ê–ü–¢–ê–¶–ò–ò
- üîÑ –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–∞ –ø–æ –∫–æ–¥—É
- üîÑ –ê–Ω–∞–ª–∏–∑ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —á–∞—Ç-–±–æ—Ç–æ–º
- üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ª–∏—Å—Ç–æ–≤

---

*–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ –≤–µ—Ä—Å–∏–∏ 3.0.8*
